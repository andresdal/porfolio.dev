---
import ExperienceItemNew from "./ExperienceItemNew.astro"
import { useTranslations } from "@/i18n/utils"

interface Props {
  lang?: string
}

const { lang = 'es' } = Astro.props
const t = useTranslations(lang as 'es' | 'en')

const EXPERIENCE = t('experience.items')
---

<div class="experience-container">
  {
    EXPERIENCE.map((experience: any, index: number) => (
      <div class="experience-item" data-index={index}>
        <ExperienceItemNew {...experience} />
      </div>
    ))
  }
</div>

<script>
  import { gsap } from 'gsap';
  import { ScrollTrigger } from 'gsap/ScrollTrigger';

  gsap.registerPlugin(ScrollTrigger);

  document.addEventListener('astro:page-load', () => {
    const experienceItems = document.querySelectorAll('.experience-item');
    
    experienceItems.forEach((item, index) => {
      gsap.to(item.querySelector('.experience-card'), {
        opacity: 1,
        x: 0,
        duration: 0.8,
        delay: index * 0.2,
        scrollTrigger: {
          trigger: item,
          start: 'top 80%',
          end: 'top 50%',
          toggleActions: 'play none none reverse'
        }
      });
    });
  });
</script>

<style>
  .experience-container {
    position: relative;
  }

  .experience-item {
    margin-bottom: 2rem;
  }
</style>
